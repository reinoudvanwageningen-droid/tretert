<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Factuur Template Builder</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ["Inter", "sans-serif"],
          },
          colors: {
            navy: "#1F2F4A",
            steel: "#2E4C6D",
            accent: "#1E7AA8",
            muted: "#6B7A90",
            surface: "#F3F6F9",
            line: "#E4EAF1",
          },
          boxShadow: {
            soft: "0 18px 45px rgba(31, 47, 74, 0.08)",
          },
        },
      },
    };
  </script>
  <style>
    :root {
      color-scheme: light;
    }

    @media print {
      body {
        background: white;
      }

      .builder-panel {
        display: none;
      }

      .invoice-wrapper {
        box-shadow: none;
        padding: 0;
      }

      .page-frame {
        box-shadow: none;
        border: none;
      }
    }
  </style>
</head>
<body class="bg-slate-50 text-navy font-sans min-h-screen">
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10">
    <header class="flex flex-col lg:flex-row lg:items-end lg:justify-between gap-6 mb-10">
      <div>
        <p class="uppercase tracking-[0.3em] text-xs text-muted">Factuursjabloon</p>
        <h1 class="text-3xl sm:text-4xl font-bold text-navy">Valinta Shipping factuur</h1>
        <p class="mt-3 text-muted max-w-2xl">
          Vul links je gegevens in en rechts zie je direct de factuur zoals in het originele ontwerp.
          Je kunt alles aanpassen en daarna printen of opslaan als PDF.
        </p>
      </div>
      <div class="flex items-center gap-3">
        <button id="resetBtn" class="px-4 py-2 rounded-full border border-muted text-muted hover:text-navy hover:border-navy transition">
          Reset voorbeeld
        </button>
        <button id="printBtn" class="px-5 py-2 rounded-full bg-accent text-white font-semibold shadow-soft hover:shadow-lg transition">
          Print/PDF
        </button>
      </div>
    </header>

    <section class="grid grid-cols-1 xl:grid-cols-[1fr_1.15fr] gap-8 items-start">
      <form id="invoiceForm" class="builder-panel bg-white rounded-3xl shadow-soft p-6 sm:p-8 space-y-8">
        <div>
          <h2 class="text-lg font-semibold text-navy">Factuurdetails</h2>
          <div class="mt-4 grid sm:grid-cols-2 gap-4">
            <label class="flex flex-col gap-2 text-sm text-muted">
              Factuurnummer
              <input name="invoiceNumber" class="rounded-xl border border-line px-4 py-2 text-navy" />
            </label>
            <label class="flex flex-col gap-2 text-sm text-muted">
              Factuurdatum
              <input name="invoiceDate" type="date" class="rounded-xl border border-line px-4 py-2 text-navy" />
            </label>
          </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6">
          <div>
            <h3 class="text-sm font-semibold text-navy">Verzender</h3>
            <div class="mt-3 space-y-3">
              <label class="flex flex-col gap-2 text-sm text-muted">Bedrijfsnaam
                <input name="senderName" class="rounded-xl border border-line px-4 py-2 text-navy" />
              </label>
              <label class="flex flex-col gap-2 text-sm text-muted">Adres
                <input name="senderStreet" class="rounded-xl border border-line px-4 py-2 text-navy" />
              </label>
              <label class="flex flex-col gap-2 text-sm text-muted">Postcode + Plaats
                <input name="senderCity" class="rounded-xl border border-line px-4 py-2 text-navy" />
              </label>
            </div>
          </div>
          <div>
            <h3 class="text-sm font-semibold text-navy">Factuuradres</h3>
            <div class="mt-3 space-y-3">
              <label class="flex flex-col gap-2 text-sm text-muted">Bedrijfsnaam
                <input name="clientName" class="rounded-xl border border-line px-4 py-2 text-navy" />
              </label>
              <label class="flex flex-col gap-2 text-sm text-muted">Adres
                <input name="clientStreet" class="rounded-xl border border-line px-4 py-2 text-navy" />
              </label>
              <label class="flex flex-col gap-2 text-sm text-muted">Postcode + Plaats
                <input name="clientCity" class="rounded-xl border border-line px-4 py-2 text-navy" />
              </label>
            </div>
          </div>
        </div>

        <div>
          <h3 class="text-sm font-semibold text-navy">Reisgegevens</h3>
          <div class="mt-3 grid sm:grid-cols-2 gap-4">
            <label class="flex flex-col gap-2 text-sm text-muted">Route
              <input name="route" class="rounded-xl border border-line px-4 py-2 text-navy" />
            </label>
            <label class="flex flex-col gap-2 text-sm text-muted">Laden / Lossen
              <input name="loadUnload" class="rounded-xl border border-line px-4 py-2 text-navy" />
            </label>
            <label class="flex flex-col gap-2 text-sm text-muted">Charter
              <input name="charter" class="rounded-xl border border-line px-4 py-2 text-navy" />
            </label>
            <label class="flex flex-col gap-2 text-sm text-muted">Betaaltermijn
              <input name="paymentTerm" class="rounded-xl border border-line px-4 py-2 text-navy" />
            </label>
          </div>
        </div>

        <div>
          <div class="flex items-center justify-between">
            <h3 class="text-sm font-semibold text-navy">Factuurregels</h3>
            <button type="button" id="addItem" class="text-sm font-semibold text-accent hover:text-navy">+ Regel toevoegen</button>
          </div>
          <div id="items" class="mt-4 space-y-4"></div>
        </div>

        <div class="grid sm:grid-cols-2 gap-4">
          <label class="flex flex-col gap-2 text-sm text-muted">BTW percentage
            <input name="vatRate" type="number" step="0.1" class="rounded-xl border border-line px-4 py-2 text-navy" />
          </label>
          <label class="flex flex-col gap-2 text-sm text-muted">Bankreferentie (IBAN)
            <input name="iban" class="rounded-xl border border-line px-4 py-2 text-navy" />
          </label>
        </div>
      </form>

      <div class="invoice-wrapper bg-white rounded-3xl shadow-soft p-6 sm:p-8">
        <div class="page-frame border border-line rounded-3xl px-8 py-10">
          <div class="flex items-start justify-between">
            <div class="flex items-center gap-4">
              <div class="w-20 h-20 rounded-full bg-white border border-line flex items-center justify-center">
                <div class="text-center">
                  <div class="text-accent font-bold text-lg leading-none">VR</div>
                  <div class="text-[10px] tracking-[0.3em] text-muted">VALINTA</div>
                </div>
              </div>
              <div>
                <p class="font-semibold text-navy" data-preview="senderName"></p>
                <p class="text-sm text-muted" data-preview="senderStreet"></p>
                <p class="text-sm text-muted" data-preview="senderCity"></p>
              </div>
            </div>
            <div class="text-right">
              <p class="text-3xl font-bold text-navy tracking-wide">FACTUUR</p>
              <p class="text-sm text-muted">Nr. <span data-preview="invoiceNumber"></span> | <span data-preview="invoiceDate"></span></p>
            </div>
          </div>

          <div class="mt-10 bg-surface border border-line rounded-2xl p-6 grid md:grid-cols-[1.1fr_1fr] gap-6">
            <div>
              <p class="text-xs font-semibold text-accent uppercase">Factuuradres</p>
              <p class="mt-4 font-semibold text-navy" data-preview="clientName"></p>
              <p class="text-sm text-muted" data-preview="clientStreet"></p>
              <p class="text-sm text-muted" data-preview="clientCity"></p>
            </div>
            <div class="border-l border-line pl-6">
              <p class="text-xs font-semibold text-accent uppercase">Reisgegevens</p>
              <div class="mt-4 space-y-2 text-sm text-muted">
                <div class="flex justify-between">
                  <span>Route</span>
                  <span class="text-navy" data-preview="route"></span>
                </div>
                <div class="flex justify-between">
                  <span>Laden / Lossen</span>
                  <span class="text-navy" data-preview="loadUnload"></span>
                </div>
                <div class="flex justify-between">
                  <span>Charter</span>
                  <span class="text-navy" data-preview="charter"></span>
                </div>
              </div>
            </div>
          </div>

          <div class="mt-10">
            <div class="grid grid-cols-[1.6fr_0.6fr_0.6fr_0.6fr_0.6fr_0.7fr] text-xs uppercase font-semibold text-muted bg-slate-100 rounded-xl px-4 py-2">
              <span>Omschrijving</span>
              <span class="text-right">Aantal</span>
              <span class="text-right">Eenheid</span>
              <span class="text-right">Prijs</span>
              <span class="text-right">Provisie</span>
              <span class="text-right">Totaal</span>
            </div>
            <div id="previewItems" class="mt-4 space-y-6"></div>
          </div>

          <div class="mt-10 flex flex-col sm:flex-row justify-between gap-6">
            <p class="text-sm text-muted" data-preview="paymentTerm"></p>
            <div class="bg-surface border border-line rounded-2xl p-5 w-full sm:max-w-sm space-y-3">
              <div class="flex justify-between text-sm text-muted">
                <span>Subtotaal</span>
                <span data-preview="subtotal"></span>
              </div>
              <div class="flex justify-between text-sm text-muted">
                <span>BTW <span data-preview="vatRate"></span></span>
                <span data-preview="vatTotal"></span>
              </div>
              <div class="border-t border-line pt-3 flex justify-between font-semibold text-navy text-lg">
                <span>TOTAAL</span>
                <span data-preview="grandTotal"></span>
              </div>
            </div>
          </div>

          <div class="mt-12 border-t-2 border-accent pt-6 text-xs text-muted grid sm:grid-cols-4 gap-4">
            <div>
              <p class="font-semibold text-navy" data-preview="senderName"></p>
              <p data-preview="senderStreet"></p>
              <p data-preview="senderCity"></p>
            </div>
            <div>
              <p>+31 6 12469494</p>
              <p>info@valinta.eu</p>
            </div>
            <div>
              <p>IBAN</p>
              <p data-preview="iban"></p>
            </div>
            <div>
              <p>KVK 90025644</p>
              <p>BTW NL865186479B01</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <template id="itemTemplate">
    <div class="grid gap-3 md:grid-cols-[1.6fr_0.6fr_0.6fr_0.6fr_0.6fr_auto] items-end bg-surface rounded-2xl p-4">
      <label class="flex flex-col gap-2 text-xs text-muted">Omschrijving
        <input name="description" class="rounded-xl border border-line px-3 py-2 text-navy" />
      </label>
      <label class="flex flex-col gap-2 text-xs text-muted">Aantal
        <input name="quantity" type="number" step="0.001" class="rounded-xl border border-line px-3 py-2 text-navy" />
      </label>
      <label class="flex flex-col gap-2 text-xs text-muted">Eenheid
        <input name="unit" class="rounded-xl border border-line px-3 py-2 text-navy" />
      </label>
      <label class="flex flex-col gap-2 text-xs text-muted">Prijs
        <input name="price" type="number" step="0.01" class="rounded-xl border border-line px-3 py-2 text-navy" />
      </label>
      <label class="flex flex-col gap-2 text-xs text-muted">Provisie %
        <input name="commission" type="number" step="0.1" class="rounded-xl border border-line px-3 py-2 text-navy" />
      </label>
      <button type="button" class="remove-item text-sm text-rose-500 font-semibold">Verwijderen</button>
    </div>
  </template>

  <script>
    const initialData = {
      invoiceNumber: "25001",
      invoiceDate: "2025-01-07",
      senderName: "Valinta Shipping vof",
      senderStreet: "Albert Schweitzerlaan 1",
      senderCity: "4281 LT Andel",
      clientName: "B.V. Bevrachtingscombinatie v/h H. Stoffers",
      clientStreet: "Gyroscoopweg 94",
      clientCity: "1042 AX Amsterdam",
      route: "Rotterdam → Wageningen",
      loadUnload: "31 dec 2024 / 6-7 jan 2025",
      charter: "BCS-241795-1",
      paymentTerm: "Betaling binnen 30 dagen na factuurdatum",
      vatRate: 21,
      iban: "NL48 ABNA 0121 9666 23",
      items: [
        {
          description: "Mais",
          quantity: 1992,
          unit: "ton",
          price: 4.75,
          commission: 5,
        },
        {
          description: "Liggeld NW11 4-01 6:00 - 7-01 12:30",
          quantity: 79,
          unit: "uur",
          price: 46.13,
          commission: 0,
        },
      ],
    };

    const form = document.getElementById("invoiceForm");
    const itemsWrapper = document.getElementById("items");
    const previewItems = document.getElementById("previewItems");
    const template = document.getElementById("itemTemplate");
    const printBtn = document.getElementById("printBtn");
    const resetBtn = document.getElementById("resetBtn");

    const currencyFormatter = new Intl.NumberFormat("nl-NL", { style: "currency", currency: "EUR" });
    const numberFormatter = new Intl.NumberFormat("nl-NL", { maximumFractionDigits: 3 });

    const updatePreview = () => {
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      const items = Array.from(itemsWrapper.querySelectorAll("[data-item]"))
        .map((itemRow) => {
          const getValue = (name) => itemRow.querySelector(`[name="${name}"]`).value;
          return {
            description: getValue("description"),
            quantity: parseFloat(getValue("quantity")) || 0,
            unit: getValue("unit"),
            price: parseFloat(getValue("price")) || 0,
            commission: parseFloat(getValue("commission")) || 0,
          };
        });

      data.items = items;
      data.vatRate = parseFloat(data.vatRate) || 0;

      document.querySelectorAll("[data-preview]").forEach((el) => {
        const key = el.dataset.preview;
        if (key === "subtotal" || key === "vatTotal" || key === "grandTotal") {
          return;
        }
        if (key === "vatRate") {
          el.textContent = `${data.vatRate}%`;
          return;
        }
        el.textContent = data[key] || "";
      });

      previewItems.innerHTML = "";
      let subtotal = 0;

      items.forEach((item) => {
        const lineBase = item.quantity * item.price;
        const commissionAmount = lineBase * (item.commission / 100);
        const lineTotal = lineBase - commissionAmount;
        subtotal += lineTotal;

        const row = document.createElement("div");
        row.className = "grid grid-cols-[1.6fr_0.6fr_0.6fr_0.6fr_0.6fr_0.7fr] gap-4 text-sm text-navy";
        row.innerHTML = `
          <div>
            <p class="font-semibold">${item.description || ""}</p>
            ${item.commission > 0 ? `<p class="text-xs text-muted">Bruto ${currencyFormatter.format(lineBase)} – provisie ${currencyFormatter.format(commissionAmount)}</p>` : ""}
          </div>
          <div class="text-right">${numberFormatter.format(item.quantity)}</div>
          <div class="text-right">${item.unit || ""}</div>
          <div class="text-right">${currencyFormatter.format(item.price)}</div>
          <div class="text-right">${item.commission ? `${item.commission}%` : "—"}</div>
          <div class="text-right font-semibold text-accent">${currencyFormatter.format(lineTotal)}</div>
        `;
        previewItems.appendChild(row);
      });

      const vatTotal = subtotal * (data.vatRate / 100);
      const grandTotal = subtotal + vatTotal;

      document.querySelector('[data-preview="subtotal"]').textContent = currencyFormatter.format(subtotal);
      document.querySelector('[data-preview="vatTotal"]').textContent = currencyFormatter.format(vatTotal);
      document.querySelector('[data-preview="grandTotal"]').textContent = currencyFormatter.format(grandTotal);
    };

    const addItemRow = (item) => {
      const clone = template.content.firstElementChild.cloneNode(true);
      clone.dataset.item = "true";
      Object.entries(item).forEach(([key, value]) => {
        const input = clone.querySelector(`[name="${key}"]`);
        if (input) {
          input.value = value;
        }
      });
      clone.querySelector(".remove-item").addEventListener("click", () => {
        clone.remove();
        updatePreview();
      });
      clone.querySelectorAll("input").forEach((input) => {
        input.addEventListener("input", updatePreview);
      });
      itemsWrapper.appendChild(clone);
    };

    const loadInitial = () => {
      form.reset();
      Object.entries(initialData).forEach(([key, value]) => {
        if (key === "items") {
          return;
        }
        const input = form.querySelector(`[name="${key}"]`);
        if (input) {
          input.value = value;
        }
      });

      itemsWrapper.innerHTML = "";
      initialData.items.forEach(addItemRow);
      updatePreview();
    };

    form.addEventListener("input", updatePreview);
    document.getElementById("addItem").addEventListener("click", () => {
      addItemRow({ description: "", quantity: 0, unit: "", price: 0, commission: 0 });
      updatePreview();
    });

    printBtn.addEventListener("click", () => {
      window.print();
    });

    resetBtn.addEventListener("click", loadInitial);

    loadInitial();
  </script>
</body>
</html>
